import{a as le,b as pe}from"./chunk-22RIDEX4.js";import{a as ie}from"./chunk-UNNSDSQF.js";import{a as Q}from"./chunk-EJTDO335.js";import{a as X}from"./chunk-Q6UAVVOY.js";import{a as se,b as de,c as ce}from"./chunk-64ZK5W7Q.js";import{f as ee,h as te,i as oe}from"./chunk-64PMGA5Q.js";import{a as N}from"./chunk-GDMQ7NQL.js";import{a as Y,b as Z,c as ne,d as ae,e as re,f as me}from"./chunk-VXZZXDIS.js";import"./chunk-5YESZIAT.js";import{B as J,C as H,D as K,b as T,d as u,g as B,h as L,i as $,k as s,l as V,n as q,q as A,s as G,t as z,u as U,y as j,z as W}from"./chunk-BMLLSFUZ.js";import{aa as w,h as D,ha as I,j as P,na as O,pa as R}from"./chunk-FRIGIZR4.js";import{Bb as r,Cb as o,Db as d,Dc as M,Ec as x,J as b,Jc as E,Kb as f,Mb as _,Ua as C,Vb as m,Wb as S,Xa as n,Xb as h,ac as k,ea as p,ka as y,nb as g,nc as F,pb as i,y as v}from"./chunk-Y3ZRIA3V.js";function ge(a,c){if(a&1&&d(0,"img",18),a&2){let e,l=_();i("src",(e=l.employeeForm.get("imgUrl"))==null?null:e.value,C)}}function he(a,c){if(a&1&&(r(0,"mat-option",19),m(1),o()),a&2){let e=c.$implicit;i("value",e.id),n(),h(" ",e.description," ")}}function fe(a,c){if(a&1&&(r(0,"mat-option",19),m(1),o()),a&2){let e=c.$implicit;i("value",e.id),n(),h(" ",e.description," ")}}function _e(a,c){if(a&1&&(r(0,"mat-option",19),m(1),o()),a&2){let e=c.$implicit;i("value",e.id),n(),h(" ",e.description," ")}}function ve(a,c){if(a&1&&(r(0,"div",20)(1,"span"),m(2,"Activo"),o(),r(3,"mat-radio-group",21)(4,"span"),m(5,"Si"),o(),d(6,"mat-radio-button",22),r(7,"span"),m(8,"No"),o(),d(9,"mat-radio-button",22),o()()),a&2){let e=_();i("appSkeleton",e.isLoading),n(6),i("value",!0),n(3),i("value",!1)}}var at=(()=>{class a{constructor(){this.isLoading=!0,this.positions=[],this.countries=[],this.genders=[{id:0,description:"No binario"},{id:1,description:"Masculino"},{id:2,description:"Femenino"}],this._fromComponentPathCalled=null,this._fromComponentNameCalled=null,this._activeRoute=p(D),this._router=p(P),this._spinnerService=p(X),this._breadcrumbService=p(re),this._alertService=p(K),this._employeeService=p(ie),this._positionService=p(ne),this._countryService=p(ae),this._feedbackDialogService=p(le),this._changeDetectorRef=p(F),this._snackbarService=p(pe),this.employeeForm=this._createForm()}ngOnInit(){this._loadRouteData(),this._setBreadcrumb(),this._loadData()}onCancel(){if(this.employeeForm.dirty){this._openFeedbackDialogWarningr();return}this._router.navigate([`/${this._fromComponentPathCalled}`])}onSave(){let e={id:this.employeeForm.value.id,imgUrl:this.employeeForm.value.imgUrl||"",name:this.employeeForm.value.name,surname:this.employeeForm.value.surname,birthDate:this.employeeForm.value.birthDate,genderId:this.employeeForm.value.genderId,countryId:this.employeeForm.value.countryId,positionId:this.employeeForm.value.positionId,active:this.operation==="create"?!0:this.employeeForm.value.active};this.operation==="create"?this._createEmployee(e):this._editEmployee(e)}isReadyToSave(){return this.employeeForm.valid&&this.employeeForm.dirty}_loadRouteData(){this._activeRoute.queryParams.subscribe(e=>{this._fromComponentPathCalled=e.componentPath,this._fromComponentNameCalled=e.componentName}),this.operation=this._activeRoute.snapshot.data.operation,this.title=this.operation==="create"?"Crear nuevo empleado":"Editar empleado"}_createForm(){return new $({id:new s(""),imgUrl:new s(""),name:new s("",u.required),surname:new s("",u.required),birthDate:new s("",u.required),genderId:new s("",u.required),countryId:new s("",u.required),positionId:new s("",u.required),active:new s("")})}_loadData(){v({positions:this._getPositions(),countries:this._getCountries()}).subscribe({next:e=>{if(this.positions=e.positions,this.countries=e.countries,this.operation==="edit"){this.isLoading=!0;let l=this._activeRoute.snapshot.paramMap.get("id");this._getEmployeeById(Number(l)).pipe(b(500)).subscribe({next:t=>{this.employeeForm.patchValue(t),this.isLoading=!1},error:t=>{this._alertService.showDanger(`Error al cargar los datos del empleado. ${t.statusText}`),this.isLoading=!1,this.employeeForm.disable(),this._changeDetectorRef.markForCheck()}})}else setTimeout(()=>{this.isLoading=!1,this._changeDetectorRef.markForCheck()},500)}})}_getEmployeeById(e){return this._employeeService.getEmployee(e)}_getPositions(){return this._positionService.getPositions()}_getCountries(){return this._countryService.getCountries()}_createEmployee(e){this._spinnerService.show(),this._employeeService.createEmployee(e).subscribe({next:()=>{setTimeout(()=>{this._spinnerService.hide(),this._openFeedbackDialogSuccess()},1500)},error:()=>{this._spinnerService.hide(),this._openFeedbackDialogDanger()}})}_editEmployee(e){this._spinnerService.show(),this._employeeService.updateEmployee(e).subscribe({next:()=>{setTimeout(()=>{this._spinnerService.hide(),this._showSnackbar(),this._router.navigate([`/${this._fromComponentPathCalled}`])},1500)},error:()=>{this._spinnerService.hide(),this._openFeedbackDialogDanger()}})}_openFeedbackDialogSuccess(){let e="creado";this._feedbackDialogService.openFeedbackDialog({type:"success",title:`Empleado ${e} con \xE9xito.`,showButtons:!0,cancelButtonText:e==="creado"?"Cancelar":"Aceptar",acceptButtonText:e==="creado"?"Crear otro":""}).afterClosed().subscribe(t=>{t===!0?this.employeeForm.reset():t===!1&&this._router.navigate([`/${this._fromComponentPathCalled}`])})}_openFeedbackDialogDanger(){let e=this.operation==="create"?"crear":"editar";this._feedbackDialogService.openFeedbackDialog({type:"danger",message:`No se pudo ${e} el empleado.`,showButtons:!0,cancelButtonText:"Cancelar",acceptButtonText:"Volver a intentar"}).afterClosed().subscribe(t=>{t===!1&&this._router.navigate([`/${this._fromComponentPathCalled}`])})}_openFeedbackDialogWarningr(){this._feedbackDialogService.openFeedbackDialog({type:"warning",title:"los cambios se perder\xE1n.",message:" \xBFEsta seguro/a que desea salir?",showButtons:!0,cancelButtonText:"Cancelar",acceptButtonText:"Aceptar"}).afterClosed().subscribe(l=>{l===!0&&this._router.navigate([`/${this._fromComponentPathCalled}`])})}_showSnackbar(){this._snackbarService.show({message:"\xA1Editado con \xE9xito!"})}_setBreadcrumb(){this._breadcrumbService.setBreadcrumbs([{label:"Inicio",path:"/"},{label:`${this._fromComponentNameCalled}`,path:`/${this._fromComponentPathCalled}`},{label:`${this.title}`,path:""}])}static{this.\u0275fac=function(l){return new(l||a)}}static{this.\u0275cmp=y({type:a,selectors:[["app-employee-form"]],standalone:!0,features:[k],decls:40,vars:19,consts:[[1,"components-container"],[1,"form-wrapper"],[1,"employee-form-container"],[3,"formGroup"],[1,"header-with-image",3,"appSkeleton"],["alt","Foto del empleado","class","employee-photo",3,"src",4,"ngIf"],["appearance","outline",3,"appSkeleton"],["matInput","","formControlName","name","appCustomValidationMessage",""],["matInput","","formControlName","surname","appCustomValidationMessage",""],["appCustomValidationMessage","",3,"formControlName","label","placeholder","isDisabled","appSkeleton"],["formControlName","genderId","appCustomValidationMessage",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","countryId","appCustomValidationMessage",""],["formControlName","positionId","appCustomValidationMessage",""],["class","radio-group-container",3,"appSkeleton",4,"ngIf"],[1,"actions-container"],["mat-button","",3,"click"],["mat-flat-button","","color","primary",3,"click","disabled"],["alt","Foto del empleado",1,"employee-photo",3,"src"],[3,"value"],[1,"radio-group-container",3,"appSkeleton"],["aria-label","Seleccionar una opci\xF3n","formControlName","active"],[1,"radio-option",3,"value"]],template:function(l,t){l&1&&(r(0,"div",0),d(1,"app-breadcrumb")(2,"app-alert"),o(),r(3,"div",1)(4,"div",2)(5,"form",3)(6,"div",4)(7,"h2"),m(8),o(),g(9,ge,1,1,"img",5),o(),r(10,"mat-form-field",6)(11,"mat-label"),m(12,"Nombre"),o(),d(13,"input",7),o(),r(14,"mat-form-field",6)(15,"mat-label"),m(16,"Apellido"),o(),d(17,"input",8),o(),d(18,"app-date-input",9),r(19,"mat-form-field",6)(20,"mat-label"),m(21,"G\xE9nero"),o(),r(22,"mat-select",10),g(23,he,2,2,"mat-option",11),o()(),r(24,"mat-form-field",6)(25,"mat-label"),m(26,"Pais"),o(),r(27,"mat-select",12),g(28,fe,2,2,"mat-option",11),o()(),r(29,"mat-form-field",6)(30,"mat-label"),m(31,"Puesto"),o(),r(32,"mat-select",13),g(33,_e,2,2,"mat-option",11),o()(),g(34,ve,10,3,"div",14),o()(),r(35,"div",15)(36,"button",16),f("click",function(){return t.onCancel()}),m(37,"Cancelar"),o(),r(38,"button",17),f("click",function(){return t.onSave()}),m(39," Guardar "),o()()()),l&2&&(n(5),i("formGroup",t.employeeForm),n(),i("appSkeleton",t.isLoading),n(2),S(t.title),n(),i("ngIf",t.operation==="edit"),n(),i("appSkeleton",t.isLoading),n(4),i("appSkeleton",t.isLoading),n(4),i("formControlName","birthDate")("label","Fecha de nacimiento")("placeholder","Fecha de nacimiento")("isDisabled",!1)("appSkeleton",t.isLoading),n(),i("appSkeleton",t.isLoading),n(4),i("ngForOf",t.genders),n(),i("appSkeleton",t.isLoading),n(4),i("ngForOf",t.countries),n(),i("appSkeleton",t.isLoading),n(4),i("ngForOf",t.positions),n(),i("ngIf",t.operation==="edit"),n(4),i("disabled",!t.isReadyToSave()))},dependencies:[E,M,x,G,V,T,B,L,z,q,A,W,j,U,H,J,R,O,oe,ee,w,Z,Y,I,me,Q,ce,se,de,N,te],styles:[".components-container[_ngcontent-%COMP%]{margin-top:20px}.form-wrapper[_ngcontent-%COMP%]{margin:20px auto;max-width:400px;padding:20px;border:1px solid #ccc;border-radius:8px;box-shadow:0 4px 8px #0000001a}.employee-form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.actions-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:16px;margin-top:20px}.radio-group-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr;align-items:center;gap:20px}.header-with-image[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.employee-photo[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;object-fit:cover;border:2px solid #ddd}.header-with-image[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.skeleton-loading[_ngcontent-%COMP%]{margin-bottom:20px!important}mat-form-field.skeleton-loading[_ngcontent-%COMP%]{margin-bottom:20px!important}.radio-group-container.skeleton-loading[_ngcontent-%COMP%]{display:block;margin-bottom:20px!important}",'.skeleton-loading[_ngcontent-%COMP%]{color:transparent!important;background-color:transparent!important;border-color:transparent!important;position:relative;overflow:hidden;pointer-events:none;min-height:1em}.skeleton-loading[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;border-radius:4px;z-index:10;background:linear-gradient(90deg,#eee 25%,#ddd,#eee 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_shimmer 1.5s infinite linear}mat-form-field.skeleton-loading[_ngcontent-%COMP%]   .mat-form-field-flex[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;border-radius:4px;z-index:10;background:linear-gradient(90deg,#eee 25%,#ddd,#eee 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_shimmer 1.5s infinite linear}button.skeleton-loading[_ngcontent-%COMP%]{background-color:#f0f0f0!important;color:transparent!important;box-shadow:none!important;position:relative;overflow:hidden}button.skeleton-loading[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;border-radius:inherit;z-index:10;background:linear-gradient(90deg,#eee 25%,#ddd,#eee 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_shimmer 1.5s infinite linear}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:200% 0}to{background-position:-200% 0}}'],changeDetection:0})}}return a})();export{at as EmployeeFormComponent};
